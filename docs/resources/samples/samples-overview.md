---
title: Office 脚本示例
description: 可用的 Office 脚本示例和方案。
ms.date: 04/01/2021
localization_priority: Normal
ms.openlocfilehash: de0e99cbac7fcdeb1a3d3c43dd72ce53ed5847dd
ms.sourcegitcommit: 5d24e77df70aa2c1c982275d53213c2a9323ff86
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/02/2021
ms.locfileid: "51571214"
---
# <a name="office-scripts-samples-and-scenarios"></a><span data-ttu-id="2cf46-103">Office 脚本示例和方案</span><span class="sxs-lookup"><span data-stu-id="2cf46-103">Office Scripts samples and scenarios</span></span>

<span data-ttu-id="2cf46-104">本节包含 [基于 Office 脚本](../../overview/excel.md) 的自动化解决方案，帮助最终用户实现日常任务的自动化。</span><span class="sxs-lookup"><span data-stu-id="2cf46-104">This section contains [Office Scripts](../../overview/excel.md) based automation solutions that help end users achieve automation of daily tasks.</span></span> <span data-ttu-id="2cf46-105">它包含业务用户面临的实际方案，并提供详细的解决方案以及分步说明视频链接。</span><span class="sxs-lookup"><span data-stu-id="2cf46-105">It contains realistic scenarios that business users face and provides detailed solutions along with step-by-step instructional video links.</span></span>

<span data-ttu-id="2cf46-106">对于 [Basics](#basics) 和 Beyond the [basics](#beyond-the-basics)中的每个项目，请查看源代码 [**、YouTube**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)视频等。</span><span class="sxs-lookup"><span data-stu-id="2cf46-106">For each of the projects in [Basics](#basics) and [Beyond the basics](#beyond-the-basics), check out the source code, step-by-step [**YouTube videos**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0), and more.</span></span>

<span data-ttu-id="2cf46-107">在 ["应用](#scenarios)场景"中，我们包含了几个演示实际用例的较大方案示例。</span><span class="sxs-lookup"><span data-stu-id="2cf46-107">In [Scenarios](#scenarios), we have included a few larger scenario samples that demonstrate real-world use cases.</span></span>

<span data-ttu-id="2cf46-108">我们还欢迎 [来自社区的贡献](#community-contributions)。</span><span class="sxs-lookup"><span data-stu-id="2cf46-108">We also welcome [contributions from the community](#community-contributions).</span></span>

[!INCLUDE [Preview note](../../includes/preview-note.md)]

## <a name="basics"></a><span data-ttu-id="2cf46-109">基本信息</span><span class="sxs-lookup"><span data-stu-id="2cf46-109">Basics</span></span>

| <span data-ttu-id="2cf46-110">Project</span><span class="sxs-lookup"><span data-stu-id="2cf46-110">Project</span></span> | <span data-ttu-id="2cf46-111">详细信息</span><span class="sxs-lookup"><span data-stu-id="2cf46-111">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="2cf46-112">脚本基础知识</span><span class="sxs-lookup"><span data-stu-id="2cf46-112">Scripting basics</span></span>](../excel-samples.md) | <span data-ttu-id="2cf46-113">这些示例演示 Office 脚本的基本构建基块。</span><span class="sxs-lookup"><span data-stu-id="2cf46-113">These samples demonstrate fundamental building blocks for Office Scripts.</span></span> |
| [<span data-ttu-id="2cf46-114">了解有关在 Office 脚本中使用 Range 对象的基础知识</span><span class="sxs-lookup"><span data-stu-id="2cf46-114">Learn basics about using the Range object in Office Scripts</span></span>](range-basics.md) | <span data-ttu-id="2cf46-115">本文介绍使用 Range 对象及其 API 的基础知识。</span><span class="sxs-lookup"><span data-stu-id="2cf46-115">This article shows the basics of using Range object and its APIs.</span></span> <span data-ttu-id="2cf46-116">这是一个基础主题，将在所有其他项目中使用。</span><span class="sxs-lookup"><span data-stu-id="2cf46-116">This is a foundational topic that'll be used across all other projects.</span></span> |

## <a name="beyond-the-basics"></a><span data-ttu-id="2cf46-117">除基础知识外</span><span class="sxs-lookup"><span data-stu-id="2cf46-117">Beyond the basics</span></span>

<span data-ttu-id="2cf46-118">请查看以下端到端项目，该项目可自动执行示例方案以及完整脚本、使用的示例 Excel 文件 [和视频](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)。</span><span class="sxs-lookup"><span data-stu-id="2cf46-118">Check out the following end-to-end project that automates sample scenarios along with full scripts, sample Excel files used, and [videos](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0).</span></span>

| <span data-ttu-id="2cf46-119">Project</span><span class="sxs-lookup"><span data-stu-id="2cf46-119">Project</span></span> | <span data-ttu-id="2cf46-120">详细信息</span><span class="sxs-lookup"><span data-stu-id="2cf46-120">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="2cf46-121">在 Excel 中添加注释</span><span class="sxs-lookup"><span data-stu-id="2cf46-121">Add comments in Excel</span></span>](add-excel-comments.md) | <span data-ttu-id="2cf46-122">本示例演示如何向单元格添加注释，包括@mentioning添加注释。</span><span class="sxs-lookup"><span data-stu-id="2cf46-122">This sample shows how to add comments to a cell including @mentioning a colleague.</span></span> |
| [<span data-ttu-id="2cf46-123">计算特定工作表或所有工作表中的空行数</span><span class="sxs-lookup"><span data-stu-id="2cf46-123">Count blank rows in a specific sheet or in all sheets</span></span>](count-blank-rows.md) | <span data-ttu-id="2cf46-124">此示例检测工作表中是否有预计存在数据的空白行，然后报告空白行计数以用于 Power Automate 流。</span><span class="sxs-lookup"><span data-stu-id="2cf46-124">This sample detects if there are any blank rows in sheets where you anticipate data to be present and then report the blank row count for usage in a Power Automate flow.</span></span> |
| [<span data-ttu-id="2cf46-125">交叉引用和格式化 Excel 文件</span><span class="sxs-lookup"><span data-stu-id="2cf46-125">Cross-reference and format an Excel file</span></span>](excel-cross-reference.md) | <span data-ttu-id="2cf46-126">此解决方案演示如何使用 Office 脚本和 Power Automate 交叉引用两个 Excel 文件并设置其格式。</span><span class="sxs-lookup"><span data-stu-id="2cf46-126">This solution shows how two Excel files can be cross-referenced and formatted using Office Scripts and Power Automate.</span></span> |
| [<span data-ttu-id="2cf46-127">电子邮件图表和表格图像</span><span class="sxs-lookup"><span data-stu-id="2cf46-127">Email chart and table images</span></span>](email-images-chart-table.md) | <span data-ttu-id="2cf46-128">此示例使用 Office 脚本和 Power Automate 操作创建图表，并通过电子邮件将图表作为图像发送。</span><span class="sxs-lookup"><span data-stu-id="2cf46-128">This sample uses Office Scripts and Power Automate actions to create a chart and send that chart as an image by email.</span></span> |
| [<span data-ttu-id="2cf46-129">筛选 Excel 表并获取可见区域</span><span class="sxs-lookup"><span data-stu-id="2cf46-129">Filter Excel table and get visible range</span></span>](filter-table-get-visible-range.md) | <span data-ttu-id="2cf46-130">此示例筛选 Excel 表，并返回可见区域作为 JSON 对象。</span><span class="sxs-lookup"><span data-stu-id="2cf46-130">This sample filters an Excel table and returns the visible range as a JSON object.</span></span> <span data-ttu-id="2cf46-131">此 JSON 可以作为较大解决方案的一部分提供给 Power Automate 流。</span><span class="sxs-lookup"><span data-stu-id="2cf46-131">This JSON could be provided to a Power Automate flow as part of a larger solution.</span></span> |
| [<span data-ttu-id="2cf46-132">在工作簿中生成唯一标识符</span><span class="sxs-lookup"><span data-stu-id="2cf46-132">Generate a unique identifier in a workbook</span></span>](document-number-generator.md) | <span data-ttu-id="2cf46-133">此方案可帮助用户生成具有特定格式的唯一文档编号，并添加一个范围或表中的条目。</span><span class="sxs-lookup"><span data-stu-id="2cf46-133">This scenario helps a user generate a unique document number with a specific format and add an entry to a range or table.</span></span> |
| [<span data-ttu-id="2cf46-134">在 Excel 中管理计算模式</span><span class="sxs-lookup"><span data-stu-id="2cf46-134">Manage calculation mode in Excel</span></span>](excel-calculation.md) | <span data-ttu-id="2cf46-135">此示例演示如何使用 Office 脚本在 Excel 网页中使用计算模式和计算方法。</span><span class="sxs-lookup"><span data-stu-id="2cf46-135">This sample shows how to use the calculation mode and calculate methods in Excel on the web using Office Scripts.</span></span> |
| [<span data-ttu-id="2cf46-136">将多个 Excel 表合并到单个表中</span><span class="sxs-lookup"><span data-stu-id="2cf46-136">Merge multiple Excel tables into a single table</span></span>](copy-tables-combine.md) | <span data-ttu-id="2cf46-137">此示例将多个 Excel 表中的数据合并到一个包含所有行的表中。</span><span class="sxs-lookup"><span data-stu-id="2cf46-137">This sample combines data from multiple Excel tables into a single table that includes all the rows.</span></span> |
| [<span data-ttu-id="2cf46-138">跨表移动行</span><span class="sxs-lookup"><span data-stu-id="2cf46-138">Move rows across tables</span></span>](move-rows-across-tables.md) | <span data-ttu-id="2cf46-139">此示例演示如何通过保存筛选器，然后处理和重新应用筛选器来跨表移动行。</span><span class="sxs-lookup"><span data-stu-id="2cf46-139">This sample shows how to move rows across tables by saving filters, then processing and reapplying the filters.</span></span> |
| [<span data-ttu-id="2cf46-140">将 Excel 数据输出为 JSON</span><span class="sxs-lookup"><span data-stu-id="2cf46-140">Output Excel data as JSON</span></span>](get-table-data.md) | <span data-ttu-id="2cf46-141">此解决方案演示如何将 Excel 表数据输出为 JSON 以在 Power Automate 中使用。</span><span class="sxs-lookup"><span data-stu-id="2cf46-141">This solution shows how to output Excel table data as JSON to use in Power Automate.</span></span> |
| [<span data-ttu-id="2cf46-142">从 Excel 工作表的每个单元格中删除超链接</span><span class="sxs-lookup"><span data-stu-id="2cf46-142">Remove hyperlinks from each cell in an Excel worksheet</span></span>](remove-hyperlinks-from-cells.md) | <span data-ttu-id="2cf46-143">本示例清除当前工作表的所有超链接。</span><span class="sxs-lookup"><span data-stu-id="2cf46-143">This sample clears all of the hyperlinks from the current worksheet.</span></span> |
| [<span data-ttu-id="2cf46-144">对文件夹中的所有 Excel 文件运行脚本</span><span class="sxs-lookup"><span data-stu-id="2cf46-144">Run a script on all Excel files in a folder</span></span>](automate-tasks-on-all-excel-files-in-folder.md) | <span data-ttu-id="2cf46-145">此项目对位于 OneDrive for Business (上的文件夹中的所有文件执行一组自动化任务，也可以用于 SharePoint 文件夹) 。</span><span class="sxs-lookup"><span data-stu-id="2cf46-145">This project performs a set of automation tasks on all files situated in a folder on OneDrive for Business (can also be used for a SharePoint folder).</span></span> <span data-ttu-id="2cf46-146">该代码对 Excel 文件执行计算，添加格式，并插入一个@mentions批注。</span><span class="sxs-lookup"><span data-stu-id="2cf46-146">It performs calculations on the Excel files, adds formatting, and inserts a comment that @mentions a colleague.</span></span> |
| [<span data-ttu-id="2cf46-147">从 Excel 数据发送 Teams 会议</span><span class="sxs-lookup"><span data-stu-id="2cf46-147">Send a Teams meeting from Excel data</span></span>](send-teams-invite-from-excel-data.md) | <span data-ttu-id="2cf46-148">此解决方案演示如何使用 Office 脚本和 Power Automate 操作从 Excel 文件选择行，并使用它发送 Teams 会议邀请，然后更新 Excel。</span><span class="sxs-lookup"><span data-stu-id="2cf46-148">This solution shows how to use Office Scripts and Power Automate actions to select rows from Excel file and use it to send a Teams meeting invite then update Excel.</span></span> |

## <a name="scenarios"></a><span data-ttu-id="2cf46-149">应用场景</span><span class="sxs-lookup"><span data-stu-id="2cf46-149">Scenarios</span></span>

<span data-ttu-id="2cf46-150">Office 脚本可以自动执行日常例程的某些部分。</span><span class="sxs-lookup"><span data-stu-id="2cf46-150">Office Scripts can automate parts of your daily routine.</span></span> <span data-ttu-id="2cf46-151">这些日常任务通常存在于独特的生态系统中，其中以特定方式设置的 Excel 工作簿。</span><span class="sxs-lookup"><span data-stu-id="2cf46-151">These day-to-day tasks often exist in unique ecosystems, with Excel workbooks that are set up in particular ways.</span></span> <span data-ttu-id="2cf46-152">这些较大的方案示例演示了此类实际用例。</span><span class="sxs-lookup"><span data-stu-id="2cf46-152">These larger scenario samples demonstrate such real-world use-cases.</span></span> <span data-ttu-id="2cf46-153">它们同时包括 Office 脚本和工作簿，因此您可从头到尾查看方案。</span><span class="sxs-lookup"><span data-stu-id="2cf46-153">They include both the Office Scripts and the workbooks, so you can see the scenario from end to end.</span></span>

| <span data-ttu-id="2cf46-154">方案</span><span class="sxs-lookup"><span data-stu-id="2cf46-154">Scenario</span></span> | <span data-ttu-id="2cf46-155">详细信息</span><span class="sxs-lookup"><span data-stu-id="2cf46-155">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="2cf46-156">分析 Web 下载项</span><span class="sxs-lookup"><span data-stu-id="2cf46-156">Analyze web downloads</span></span>](../scenarios/analyze-web-downloads.md) | <span data-ttu-id="2cf46-157">此方案具有分析 Web 流量记录的脚本，以确定用户的来源国家/地区。</span><span class="sxs-lookup"><span data-stu-id="2cf46-157">This scenario features a script that parses web traffic records to determine a user's country of origin.</span></span> <span data-ttu-id="2cf46-158">它展示文本分析、在脚本中使用子功能、应用条件格式和使用表的技能。</span><span class="sxs-lookup"><span data-stu-id="2cf46-158">It showcases the skills of text parsing, using subfunctions in scripts, applying conditional formatting, and working with tables.</span></span> |
| [<span data-ttu-id="2cf46-159">从 NOAA 中提取图形水级别的数据</span><span class="sxs-lookup"><span data-stu-id="2cf46-159">Fetch and graph water-level data from NOAA</span></span>](../scenarios/noaa-data-fetch.md) | <span data-ttu-id="2cf46-160">此方案使用 Office 脚本从 [NOAA](https://tidesandcurrents.noaa.gov/) (当前数据库的外部源提取数据) 并绘制结果信息的图形。</span><span class="sxs-lookup"><span data-stu-id="2cf46-160">This scenario uses an Office Script to pull data from an external source (the [NOAA Tides and Currents database](https://tidesandcurrents.noaa.gov/)) and graph the resulting information.</span></span> <span data-ttu-id="2cf46-161">它重点介绍了使用 `fetch` 获取数据和使用图表的技能。</span><span class="sxs-lookup"><span data-stu-id="2cf46-161">It highlights the skills of using `fetch` to get data and using charts.</span></span> |
| [<span data-ttu-id="2cf46-162">成绩计算器</span><span class="sxs-lookup"><span data-stu-id="2cf46-162">Grade calculator</span></span>](../scenarios/grade-calculator.md) | <span data-ttu-id="2cf46-163">此方案具有一个脚本，用于验证教师的课堂成绩记录。</span><span class="sxs-lookup"><span data-stu-id="2cf46-163">This scenario features a script that validates an instructor's record for their class's grades.</span></span> <span data-ttu-id="2cf46-164">它展示错误检查、单元格格式设置和正则表达式的技能。</span><span class="sxs-lookup"><span data-stu-id="2cf46-164">It showcases the skills of error checking, cell formatting, and regular expressions.</span></span> |
| [<span data-ttu-id="2cf46-165">任务提醒</span><span class="sxs-lookup"><span data-stu-id="2cf46-165">Task reminders</span></span>](../scenarios/task-reminders.md) | <span data-ttu-id="2cf46-166">此方案在 Power Automate 流中使用 Office 脚本向同事发送提醒，以更新项目状态。</span><span class="sxs-lookup"><span data-stu-id="2cf46-166">This scenario uses an Office Script in a Power Automate flow to send reminders to coworkers to update a project's status.</span></span> <span data-ttu-id="2cf46-167">它重点介绍了 Power Automate 集成以及与脚本之间传输数据的技能。</span><span class="sxs-lookup"><span data-stu-id="2cf46-167">It highlights the skills of Power Automate integration and data transfer to and from scripts.</span></span> |

## <a name="community-contributions"></a><span data-ttu-id="2cf46-168">社区贡献</span><span class="sxs-lookup"><span data-stu-id="2cf46-168">Community contributions</span></span>

<span data-ttu-id="2cf46-169">欢迎来自[](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md) Office 脚本社区的贡献！</span><span class="sxs-lookup"><span data-stu-id="2cf46-169">We welcome [contributions](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md) from our Office Scripts community!</span></span> <span data-ttu-id="2cf46-170">可随意创建拉取请求进行审阅。</span><span class="sxs-lookup"><span data-stu-id="2cf46-170">Feel free to create a pull request for review.</span></span>

| <span data-ttu-id="2cf46-171">Project</span><span class="sxs-lookup"><span data-stu-id="2cf46-171">Project</span></span> | <span data-ttu-id="2cf46-172">详细信息</span><span class="sxs-lookup"><span data-stu-id="2cf46-172">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="2cf46-173">四年问候语动画</span><span class="sxs-lookup"><span data-stu-id="2cf46-173">Seasons greetings animation</span></span>](community-seasons-greetings.md) | <span data-ttu-id="2cf46-174">此脚本由 [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) 在假日假日的快乐中贡献！</span><span class="sxs-lookup"><span data-stu-id="2cf46-174">This script was contributed by [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) in the spirit of the holiday season!</span></span> <span data-ttu-id="2cf46-175">这是一个有趣脚本，它使用 Office 脚本在 Excel 网页中显示一个百叶树。</span><span class="sxs-lookup"><span data-stu-id="2cf46-175">It's a fun script that shows a singing Christmas tree in Excel on the web using Office Scripts.</span></span> |

## <a name="try-it-out"></a><span data-ttu-id="2cf46-176">试用</span><span class="sxs-lookup"><span data-stu-id="2cf46-176">Try it out</span></span>

<span data-ttu-id="2cf46-177">这些示例是开源的。</span><span class="sxs-lookup"><span data-stu-id="2cf46-177">These samples are open source.</span></span> <span data-ttu-id="2cf46-178">尝试一下。</span><span class="sxs-lookup"><span data-stu-id="2cf46-178">Try them out yourself.</span></span> <span data-ttu-id="2cf46-179">你需要从工作或学校获得 Microsoft 工作或学校帐户，并拥有使用 E3 或 (Microsoft 365 订阅) 。</span><span class="sxs-lookup"><span data-stu-id="2cf46-179">You'll need a Microsoft work or school account from work or school with a license to Microsoft 365 subscription (E3 or above).</span></span> <span data-ttu-id="2cf46-180">只需前往登录 https://office.com 帐户并开始使用。</span><span class="sxs-lookup"><span data-stu-id="2cf46-180">Just head over to https://office.com to sign in to your account and get started.</span></span>

## <a name="leave-a-comment"></a><span data-ttu-id="2cf46-181">留下注释</span><span class="sxs-lookup"><span data-stu-id="2cf46-181">Leave a comment</span></span>

<span data-ttu-id="2cf46-182">使用特定示例的文档页面底部的"反馈"部分，可以随意留下评论、提出建议或记录问题。</span><span class="sxs-lookup"><span data-stu-id="2cf46-182">Feel free to leave a comment, make a suggestion, or log an issue by using the **Feedback** section at the bottom of the specific sample's documentation page.</span></span>
