---
title: Office脚本示例
description: 可用于Office脚本示例和方案。
ms.date: 04/28/2021
localization_priority: Normal
ms.openlocfilehash: 625db792763606e8db77abdc4665b7db2732892f
ms.sourcegitcommit: f7a7aebfb687f2a35dbed07ed62ff352a114525a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/06/2021
ms.locfileid: "52232737"
---
# <a name="office-scripts-samples-and-scenarios"></a><span data-ttu-id="f3237-103">Office脚本示例和方案</span><span class="sxs-lookup"><span data-stu-id="f3237-103">Office Scripts samples and scenarios</span></span>

<span data-ttu-id="f3237-104">本节包含[Office](../../overview/excel.md)脚本的自动化解决方案，帮助最终用户实现日常任务的自动化。</span><span class="sxs-lookup"><span data-stu-id="f3237-104">This section contains [Office Scripts](../../overview/excel.md) based automation solutions that help end users achieve automation of daily tasks.</span></span> <span data-ttu-id="f3237-105">它包含业务用户面临的实际方案，并提供详细的解决方案以及分步说明视频链接。</span><span class="sxs-lookup"><span data-stu-id="f3237-105">It contains realistic scenarios that business users face and provides detailed solutions along with step-by-step instructional video links.</span></span>

<span data-ttu-id="f3237-106">对于 [Basics](#basics) 和 Beyond the [basics](#beyond-the-basics)中的每个项目，请查看源代码 [**、YouTube**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)视频等。</span><span class="sxs-lookup"><span data-stu-id="f3237-106">For each of the projects in [Basics](#basics) and [Beyond the basics](#beyond-the-basics), check out the source code, step-by-step [**YouTube videos**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0), and more.</span></span>

<span data-ttu-id="f3237-107">在 ["应用](#scenarios)场景"中，我们包含了几个演示实际用例的较大方案示例。</span><span class="sxs-lookup"><span data-stu-id="f3237-107">In [Scenarios](#scenarios), we have included a few larger scenario samples that demonstrate real-world use cases.</span></span>

<span data-ttu-id="f3237-108">我们还欢迎 [来自社区的贡献](#community-contributions)。</span><span class="sxs-lookup"><span data-stu-id="f3237-108">We also welcome [contributions from the community](#community-contributions).</span></span>

[!INCLUDE [Preview note](../../includes/preview-note.md)]

## <a name="basics"></a><span data-ttu-id="f3237-109">基本信息</span><span class="sxs-lookup"><span data-stu-id="f3237-109">Basics</span></span>

| <span data-ttu-id="f3237-110">Project</span><span class="sxs-lookup"><span data-stu-id="f3237-110">Project</span></span> | <span data-ttu-id="f3237-111">详细信息</span><span class="sxs-lookup"><span data-stu-id="f3237-111">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="f3237-112">脚本基础知识</span><span class="sxs-lookup"><span data-stu-id="f3237-112">Scripting basics</span></span>](../excel-samples.md) | <span data-ttu-id="f3237-113">这些示例演示了脚本的基本Office构建基块。</span><span class="sxs-lookup"><span data-stu-id="f3237-113">These samples demonstrate fundamental building blocks for Office Scripts.</span></span> |
| [<span data-ttu-id="f3237-114">在内容中添加Excel</span><span class="sxs-lookup"><span data-stu-id="f3237-114">Add comments in Excel</span></span>](add-excel-comments.md) | <span data-ttu-id="f3237-115">本示例演示如何向单元格添加注释，包括@mentioning添加注释。</span><span class="sxs-lookup"><span data-stu-id="f3237-115">This sample shows how to add comments to a cell including @mentioning a colleague.</span></span> |
| [<span data-ttu-id="f3237-116">将多个Excel表复制到单个表中</span><span class="sxs-lookup"><span data-stu-id="f3237-116">Copy multiple Excel tables into a single table</span></span>](copy-tables-combine.md) | <span data-ttu-id="f3237-117">此示例将来自多个Excel的数据组合到一个包含所有行的表中。</span><span class="sxs-lookup"><span data-stu-id="f3237-117">This sample combines data from multiple Excel tables into a single table that includes all the rows.</span></span> |

## <a name="beyond-the-basics"></a><span data-ttu-id="f3237-118">超越基础设置</span><span class="sxs-lookup"><span data-stu-id="f3237-118">Beyond the basics</span></span>

<span data-ttu-id="f3237-119">请查看以下端到端项目，该项目可自动执行示例方案以及 YouTube) 上承载的完整脚本、Excel 文件示例[ (。 ](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)</span><span class="sxs-lookup"><span data-stu-id="f3237-119">Check out the following end-to-end project that automates sample scenarios along with full scripts, sample Excel files used, and [videos (hosted on YouTube)](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0).</span></span>

| <span data-ttu-id="f3237-120">Project</span><span class="sxs-lookup"><span data-stu-id="f3237-120">Project</span></span> | <span data-ttu-id="f3237-121">详细信息</span><span class="sxs-lookup"><span data-stu-id="f3237-121">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="f3237-122">计算特定工作表或所有工作表中的空行数</span><span class="sxs-lookup"><span data-stu-id="f3237-122">Count blank rows in a specific sheet or in all sheets</span></span>](count-blank-rows.md) | <span data-ttu-id="f3237-123">本示例检测工作表中是否有预计存在数据的空白行，然后报告空白行计数，以用于Power Automate流。</span><span class="sxs-lookup"><span data-stu-id="f3237-123">This sample detects if there are any blank rows in sheets where you anticipate data to be present and then report the blank row count for usage in a Power Automate flow.</span></span> |
| [<span data-ttu-id="f3237-124">交叉引用和格式化Excel文件</span><span class="sxs-lookup"><span data-stu-id="f3237-124">Cross-reference and format an Excel file</span></span>](excel-cross-reference.md) | <span data-ttu-id="f3237-125">此解决方案演示如何使用脚本Excel脚本和脚本对两个Office文件进行交叉Power Automate。</span><span class="sxs-lookup"><span data-stu-id="f3237-125">This solution shows how two Excel files can be cross-referenced and formatted using Office Scripts and Power Automate.</span></span> |
| [<span data-ttu-id="f3237-126">电子邮件图表和表格图像</span><span class="sxs-lookup"><span data-stu-id="f3237-126">Email chart and table images</span></span>](email-images-chart-table.md) | <span data-ttu-id="f3237-127">此示例使用Office脚本Power Automate操作来创建图表，并通过电子邮件将图表作为图像发送。</span><span class="sxs-lookup"><span data-stu-id="f3237-127">This sample uses Office Scripts and Power Automate actions to create a chart and send that chart as an image by email.</span></span> |
| [<span data-ttu-id="f3237-128">外部提取调用</span><span class="sxs-lookup"><span data-stu-id="f3237-128">External fetch calls</span></span>](external-fetch-calls.md) | <span data-ttu-id="f3237-129">此示例使用 `fetch` 从脚本的 GitHub获取信息。</span><span class="sxs-lookup"><span data-stu-id="f3237-129">This sample uses `fetch` to get information from GitHub for the script.</span></span> |
| [<span data-ttu-id="f3237-130">筛选Excel并获取可见区域</span><span class="sxs-lookup"><span data-stu-id="f3237-130">Filter Excel table and get visible range</span></span>](filter-table-get-visible-range.md) | <span data-ttu-id="f3237-131">此示例筛选一Excel，并作为 JSON 对象返回可见区域。</span><span class="sxs-lookup"><span data-stu-id="f3237-131">This sample filters an Excel table and returns the visible range as a JSON object.</span></span> <span data-ttu-id="f3237-132">此 JSON 可以作为较大解决方案的Power Automate提供给一个流。</span><span class="sxs-lookup"><span data-stu-id="f3237-132">This JSON could be provided to a Power Automate flow as part of a larger solution.</span></span> |
| [<span data-ttu-id="f3237-133">在工作簿中生成唯一标识符</span><span class="sxs-lookup"><span data-stu-id="f3237-133">Generate a unique identifier in a workbook</span></span>](document-number-generator.md) | <span data-ttu-id="f3237-134">此方案可帮助用户生成具有特定格式的唯一文档编号，并添加一个范围或表中的条目。</span><span class="sxs-lookup"><span data-stu-id="f3237-134">This scenario helps a user generate a unique document number with a specific format and add an entry to a range or table.</span></span> |
| [<span data-ttu-id="f3237-135">在计算模式下管理Excel</span><span class="sxs-lookup"><span data-stu-id="f3237-135">Manage calculation mode in Excel</span></span>](excel-calculation.md) | <span data-ttu-id="f3237-136">此示例演示如何在脚本中使用计算模式Excel web 版计算Office方法。</span><span class="sxs-lookup"><span data-stu-id="f3237-136">This sample shows how to use the calculation mode and calculate methods in Excel on the web using Office Scripts.</span></span> |
| [<span data-ttu-id="f3237-137">跨表移动行</span><span class="sxs-lookup"><span data-stu-id="f3237-137">Move rows across tables</span></span>](move-rows-across-tables.md) | <span data-ttu-id="f3237-138">此示例演示如何通过保存筛选器，然后处理和重新应用筛选器来跨表移动行。</span><span class="sxs-lookup"><span data-stu-id="f3237-138">This sample shows how to move rows across tables by saving filters, then processing and reapplying the filters.</span></span> |
| [<span data-ttu-id="f3237-139">输出Excel JSON</span><span class="sxs-lookup"><span data-stu-id="f3237-139">Output Excel data as JSON</span></span>](get-table-data.md) | <span data-ttu-id="f3237-140">此解决方案演示如何将Excel数据输出为 JSON，以用于Power Automate。</span><span class="sxs-lookup"><span data-stu-id="f3237-140">This solution shows how to output Excel table data as JSON to use in Power Automate.</span></span> |
| [<span data-ttu-id="f3237-141">从工作表的每个单元格中删除Excel超链接</span><span class="sxs-lookup"><span data-stu-id="f3237-141">Remove hyperlinks from each cell in an Excel worksheet</span></span>](remove-hyperlinks-from-cells.md) | <span data-ttu-id="f3237-142">本示例清除当前工作表的所有超链接。</span><span class="sxs-lookup"><span data-stu-id="f3237-142">This sample clears all of the hyperlinks from the current worksheet.</span></span> |
| [<span data-ttu-id="f3237-143">对文件夹中的所有 Excel 文件运行脚本</span><span class="sxs-lookup"><span data-stu-id="f3237-143">Run a script on all Excel files in a folder</span></span>](automate-tasks-on-all-excel-files-in-folder.md) | <span data-ttu-id="f3237-144">此项目对位于 OneDrive for Business (文件夹中的所有文件执行一组自动化任务，SharePoint文件夹) 。</span><span class="sxs-lookup"><span data-stu-id="f3237-144">This project performs a set of automation tasks on all files situated in a folder on OneDrive for Business (can also be used for a SharePoint folder).</span></span> <span data-ttu-id="f3237-145">该代码对Excel文件执行计算，添加格式，并插入一个@mentions注释。</span><span class="sxs-lookup"><span data-stu-id="f3237-145">It performs calculations on the Excel files, adds formatting, and inserts a comment that @mentions a colleague.</span></span> |
| [<span data-ttu-id="f3237-146">从Teams数据发送Excel会议</span><span class="sxs-lookup"><span data-stu-id="f3237-146">Send a Teams meeting from Excel data</span></span>](send-teams-invite-from-excel-data.md) | <span data-ttu-id="f3237-147">此解决方案演示如何使用 Office 脚本和 Power Automate 操作从 Excel 文件选择行，并使用它发送 Teams 会议邀请，然后更新Excel。</span><span class="sxs-lookup"><span data-stu-id="f3237-147">This solution shows how to use Office Scripts and Power Automate actions to select rows from Excel file and use it to send a Teams meeting invite then update Excel.</span></span> |

## <a name="scenarios"></a><span data-ttu-id="f3237-148">应用场景</span><span class="sxs-lookup"><span data-stu-id="f3237-148">Scenarios</span></span>

<span data-ttu-id="f3237-149">Office脚本可以自动执行日常例程的某些部分。</span><span class="sxs-lookup"><span data-stu-id="f3237-149">Office Scripts can automate parts of your daily routine.</span></span> <span data-ttu-id="f3237-150">这些日常任务通常存在于独特的生态系统中，其中Excel以特定方式设置的特定工作簿。</span><span class="sxs-lookup"><span data-stu-id="f3237-150">These day-to-day tasks often exist in unique ecosystems, with Excel workbooks that are set up in particular ways.</span></span> <span data-ttu-id="f3237-151">这些较大的方案示例演示了此类实际用例。</span><span class="sxs-lookup"><span data-stu-id="f3237-151">These larger scenario samples demonstrate such real-world use-cases.</span></span> <span data-ttu-id="f3237-152">它们包括Office脚本和工作簿，因此您可从头到尾查看方案。</span><span class="sxs-lookup"><span data-stu-id="f3237-152">They include both the Office Scripts and the workbooks, so you can see the scenario from end to end.</span></span>

| <span data-ttu-id="f3237-153">应用场景</span><span class="sxs-lookup"><span data-stu-id="f3237-153">Scenario</span></span> | <span data-ttu-id="f3237-154">详细信息</span><span class="sxs-lookup"><span data-stu-id="f3237-154">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="f3237-155">分析 Web 下载项</span><span class="sxs-lookup"><span data-stu-id="f3237-155">Analyze web downloads</span></span>](../scenarios/analyze-web-downloads.md) | <span data-ttu-id="f3237-156">此方案具有分析 Web 流量记录的脚本，以确定用户的来源国家/地区。</span><span class="sxs-lookup"><span data-stu-id="f3237-156">This scenario features a script that parses web traffic records to determine a user's country of origin.</span></span> <span data-ttu-id="f3237-157">它展示文本分析、在脚本中使用子功能、应用条件格式和使用表的技能。</span><span class="sxs-lookup"><span data-stu-id="f3237-157">It showcases the skills of text parsing, using subfunctions in scripts, applying conditional formatting, and working with tables.</span></span> |
| [<span data-ttu-id="f3237-158">从 NOAA 中提取图形水级别的数据</span><span class="sxs-lookup"><span data-stu-id="f3237-158">Fetch and graph water-level data from NOAA</span></span>](../scenarios/noaa-data-fetch.md) | <span data-ttu-id="f3237-159">此方案使用Office脚本从 NOAA ([Currents](https://tidesandcurrents.noaa.gov/)数据库的外部源提取数据) 并绘制结果信息的图形。</span><span class="sxs-lookup"><span data-stu-id="f3237-159">This scenario uses an Office Script to pull data from an external source (the [NOAA Tides and Currents database](https://tidesandcurrents.noaa.gov/)) and graph the resulting information.</span></span> <span data-ttu-id="f3237-160">它重点介绍了使用 `fetch` 获取数据和使用图表的技能。</span><span class="sxs-lookup"><span data-stu-id="f3237-160">It highlights the skills of using `fetch` to get data and using charts.</span></span> |
| [<span data-ttu-id="f3237-161">成绩计算器</span><span class="sxs-lookup"><span data-stu-id="f3237-161">Grade calculator</span></span>](../scenarios/grade-calculator.md) | <span data-ttu-id="f3237-162">此方案具有一个脚本，用于验证教师的课堂成绩记录。</span><span class="sxs-lookup"><span data-stu-id="f3237-162">This scenario features a script that validates an instructor's record for their class's grades.</span></span> <span data-ttu-id="f3237-163">它展示错误检查、单元格格式设置和正则表达式的技能。</span><span class="sxs-lookup"><span data-stu-id="f3237-163">It showcases the skills of error checking, cell formatting, and regular expressions.</span></span> |
| [<span data-ttu-id="f3237-164">任务提醒</span><span class="sxs-lookup"><span data-stu-id="f3237-164">Task reminders</span></span>](../scenarios/task-reminders.md) | <span data-ttu-id="f3237-165">此方案在Office流Power Automate脚本，向同事发送更新项目状态的提醒。</span><span class="sxs-lookup"><span data-stu-id="f3237-165">This scenario uses an Office Script in a Power Automate flow to send reminders to coworkers to update a project's status.</span></span> <span data-ttu-id="f3237-166">它重点介绍了脚本Power Automate和数据传输的专业技能。</span><span class="sxs-lookup"><span data-stu-id="f3237-166">It highlights the skills of Power Automate integration and data transfer to and from scripts.</span></span> |

## <a name="community-contributions"></a><span data-ttu-id="f3237-167">社区参与</span><span class="sxs-lookup"><span data-stu-id="f3237-167">Community contributions</span></span>

<span data-ttu-id="f3237-168">欢迎来自[我们的](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md)脚本Office贡献！</span><span class="sxs-lookup"><span data-stu-id="f3237-168">We welcome [contributions](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md) from our Office Scripts community!</span></span> <span data-ttu-id="f3237-169">可随意创建拉取请求进行审阅。</span><span class="sxs-lookup"><span data-stu-id="f3237-169">Feel free to create a pull request for review.</span></span>

| <span data-ttu-id="f3237-170">Project</span><span class="sxs-lookup"><span data-stu-id="f3237-170">Project</span></span> | <span data-ttu-id="f3237-171">详细信息</span><span class="sxs-lookup"><span data-stu-id="f3237-171">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="f3237-172">四年问候语动画</span><span class="sxs-lookup"><span data-stu-id="f3237-172">Seasons greetings animation</span></span>](community-seasons-greetings.md) | <span data-ttu-id="f3237-173">此脚本由 [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) 在假日假日的快乐中贡献！</span><span class="sxs-lookup"><span data-stu-id="f3237-173">This script was contributed by [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) in the spirit of the holiday season!</span></span> <span data-ttu-id="f3237-174">这是一个有趣的脚本，它使用脚本在Excel web 版中显示一Office树。</span><span class="sxs-lookup"><span data-stu-id="f3237-174">It's a fun script that shows a singing Christmas tree in Excel on the web using Office Scripts.</span></span> |

## <a name="try-it-out"></a><span data-ttu-id="f3237-175">试用</span><span class="sxs-lookup"><span data-stu-id="f3237-175">Try it out</span></span>

<span data-ttu-id="f3237-176">这些示例是开源的。</span><span class="sxs-lookup"><span data-stu-id="f3237-176">These samples are open source.</span></span> <span data-ttu-id="f3237-177">尝试一下。</span><span class="sxs-lookup"><span data-stu-id="f3237-177">Try them out yourself.</span></span> <span data-ttu-id="f3237-178">你将需要来自工作或学校的 Microsoft 工作或学校帐户，并拥有许可证才能Microsoft 365 E3 (或) 。</span><span class="sxs-lookup"><span data-stu-id="f3237-178">You'll need a Microsoft work or school account from work or school with a license to Microsoft 365 subscription (E3 or above).</span></span> <span data-ttu-id="f3237-179">只需前往登录 https://office.com 帐户并开始使用。</span><span class="sxs-lookup"><span data-stu-id="f3237-179">Just head over to https://office.com to sign in to your account and get started.</span></span>

## <a name="leave-a-comment"></a><span data-ttu-id="f3237-180">留下注释</span><span class="sxs-lookup"><span data-stu-id="f3237-180">Leave a comment</span></span>

<span data-ttu-id="f3237-181">使用特定示例的文档页面底部的"反馈"部分，可以随意留下评论、提出建议或记录问题。</span><span class="sxs-lookup"><span data-stu-id="f3237-181">Feel free to leave a comment, make a suggestion, or log an issue by using the **Feedback** section at the bottom of the specific sample's documentation page.</span></span>
