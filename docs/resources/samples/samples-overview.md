---
title: Office脚本示例
description: 可用于Office脚本示例和方案。
ms.date: 05/25/2021
localization_priority: Normal
ms.openlocfilehash: 1b7e9cdd9e23f57d59e5e878a37b50afb63965fd
ms.sourcegitcommit: a063b3faf6c1b7c294bd6a73e46845b352f2a22d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/29/2021
ms.locfileid: "53202849"
---
# <a name="office-scripts-samples-and-scenarios"></a><span data-ttu-id="12f34-103">Office脚本示例和方案</span><span class="sxs-lookup"><span data-stu-id="12f34-103">Office Scripts samples and scenarios</span></span>

<span data-ttu-id="12f34-104">本节包含[Office](../../overview/excel.md)脚本的自动化解决方案，帮助最终用户实现日常任务的自动化。</span><span class="sxs-lookup"><span data-stu-id="12f34-104">This section contains [Office Scripts](../../overview/excel.md) based automation solutions that help end users achieve automation of daily tasks.</span></span> <span data-ttu-id="12f34-105">它包含业务用户面临的实际方案，并提供详细的解决方案以及分步说明视频链接。</span><span class="sxs-lookup"><span data-stu-id="12f34-105">It contains realistic scenarios that business users face and provides detailed solutions along with step-by-step instructional video links.</span></span>

<span data-ttu-id="12f34-106">对于 [Basics](#basics) 和 Beyond the [basics](#beyond-the-basics)中的每个项目，请查看源代码 [**、YouTube**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)视频等。</span><span class="sxs-lookup"><span data-stu-id="12f34-106">For each of the projects in [Basics](#basics) and [Beyond the basics](#beyond-the-basics), check out the source code, step-by-step [**YouTube videos**](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0), and more.</span></span>

<span data-ttu-id="12f34-107">在 ["应用](#scenarios)场景"中，我们包含了几个演示实际用例的较大方案示例。</span><span class="sxs-lookup"><span data-stu-id="12f34-107">In [Scenarios](#scenarios), we have included a few larger scenario samples that demonstrate real-world use cases.</span></span>

<span data-ttu-id="12f34-108">我们还欢迎 [来自社区的贡献](#community-contributions-and-fun-samples)。</span><span class="sxs-lookup"><span data-stu-id="12f34-108">We also welcome [contributions from the community](#community-contributions-and-fun-samples).</span></span>

## <a name="basics"></a><span data-ttu-id="12f34-109">基本信息</span><span class="sxs-lookup"><span data-stu-id="12f34-109">Basics</span></span>

| <span data-ttu-id="12f34-110">Project</span><span class="sxs-lookup"><span data-stu-id="12f34-110">Project</span></span> | <span data-ttu-id="12f34-111">详细信息</span><span class="sxs-lookup"><span data-stu-id="12f34-111">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="12f34-112">脚本基础知识</span><span class="sxs-lookup"><span data-stu-id="12f34-112">Scripting basics</span></span>](../excel-samples.md) | <span data-ttu-id="12f34-113">这些示例演示了脚本的基本Office构建基块。</span><span class="sxs-lookup"><span data-stu-id="12f34-113">These samples demonstrate fundamental building blocks for Office Scripts.</span></span> |
| [<span data-ttu-id="12f34-114">在内容中添加Excel</span><span class="sxs-lookup"><span data-stu-id="12f34-114">Add comments in Excel</span></span>](add-excel-comments.md) | <span data-ttu-id="12f34-115">本示例向单元格添加注释，@mentioning同事。</span><span class="sxs-lookup"><span data-stu-id="12f34-115">This sample adds comments to a cell including @mentioning a colleague.</span></span> |
| [<span data-ttu-id="12f34-116">向工作簿添加图像</span><span class="sxs-lookup"><span data-stu-id="12f34-116">Add images to a workbook</span></span>](add-image-to-workbook.md) | <span data-ttu-id="12f34-117">本示例向工作簿添加一个图像，并跨工作表复制一个图像。</span><span class="sxs-lookup"><span data-stu-id="12f34-117">This sample adds an image to a workbook and copies an image across sheets.</span></span>|
| [<span data-ttu-id="12f34-118">将多个Excel表复制到单个表中</span><span class="sxs-lookup"><span data-stu-id="12f34-118">Copy multiple Excel tables into a single table</span></span>](copy-tables-combine.md) | <span data-ttu-id="12f34-119">此示例将来自多个Excel的数据组合到一个包含所有行的表中。</span><span class="sxs-lookup"><span data-stu-id="12f34-119">This sample combines data from multiple Excel tables into a single table that includes all the rows.</span></span> |

## <a name="beyond-the-basics"></a><span data-ttu-id="12f34-120">超越基础设置</span><span class="sxs-lookup"><span data-stu-id="12f34-120">Beyond the basics</span></span>

<span data-ttu-id="12f34-121">请查看以下端到端项目，该项目可自动执行示例方案以及 YouTube) 上承载的完整脚本、Excel 文件示例[ (。 ](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0)</span><span class="sxs-lookup"><span data-stu-id="12f34-121">Check out the following end-to-end project that automates sample scenarios along with full scripts, sample Excel files used, and [videos (hosted on YouTube)](https://www.youtube.com/playlist?list=PLr3zVPZrMOUMl88fs8uc2GGAePRnNe6m0).</span></span>

| <span data-ttu-id="12f34-122">Project</span><span class="sxs-lookup"><span data-stu-id="12f34-122">Project</span></span> | <span data-ttu-id="12f34-123">详细信息</span><span class="sxs-lookup"><span data-stu-id="12f34-123">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="12f34-124">交叉引用工作簿</span><span class="sxs-lookup"><span data-stu-id="12f34-124">Cross-reference workbooks</span></span>](excel-cross-reference.md) | <span data-ttu-id="12f34-125">此示例使用Office脚本Power Automate来交叉引用和验证不同工作簿中的信息。</span><span class="sxs-lookup"><span data-stu-id="12f34-125">This sample uses Office Scripts and Power Automate to cross-reference and validate information in different workbooks.</span></span> |
| [<span data-ttu-id="12f34-126">计算特定工作表或所有工作表中的空行数</span><span class="sxs-lookup"><span data-stu-id="12f34-126">Count blank rows in a specific sheet or in all sheets</span></span>](count-blank-rows.md) | <span data-ttu-id="12f34-127">本示例检测工作表中是否有预计存在数据的空白行，然后报告空白行计数，以用于Power Automate流。</span><span class="sxs-lookup"><span data-stu-id="12f34-127">This sample detects if there are any blank rows in sheets where you anticipate data to be present and then report the blank row count for usage in a Power Automate flow.</span></span> |
| [<span data-ttu-id="12f34-128">电子邮件图表和表格图像</span><span class="sxs-lookup"><span data-stu-id="12f34-128">Email chart and table images</span></span>](email-images-chart-table.md) | <span data-ttu-id="12f34-129">此示例使用Office脚本Power Automate操作来创建图表，并通过电子邮件将图表作为图像发送。</span><span class="sxs-lookup"><span data-stu-id="12f34-129">This sample uses Office Scripts and Power Automate actions to create a chart and send that chart as an image by email.</span></span> |
| [<span data-ttu-id="12f34-130">外部提取调用</span><span class="sxs-lookup"><span data-stu-id="12f34-130">External fetch calls</span></span>](external-fetch-calls.md) | <span data-ttu-id="12f34-131">此示例使用 `fetch` 从脚本的 GitHub获取信息。</span><span class="sxs-lookup"><span data-stu-id="12f34-131">This sample uses `fetch` to get information from GitHub for the script.</span></span> |
| [<span data-ttu-id="12f34-132">筛选Excel并获取可见区域</span><span class="sxs-lookup"><span data-stu-id="12f34-132">Filter Excel table and get visible range</span></span>](filter-table-get-visible-range.md) | <span data-ttu-id="12f34-133">此示例筛选一Excel，并作为 JSON 对象返回可见区域。</span><span class="sxs-lookup"><span data-stu-id="12f34-133">This sample filters an Excel table and returns the visible range as a JSON object.</span></span> <span data-ttu-id="12f34-134">此 JSON 可以作为较大解决方案的Power Automate提供给一个流。</span><span class="sxs-lookup"><span data-stu-id="12f34-134">This JSON could be provided to a Power Automate flow as part of a larger solution.</span></span> |
| [<span data-ttu-id="12f34-135">在计算模式下管理Excel</span><span class="sxs-lookup"><span data-stu-id="12f34-135">Manage calculation mode in Excel</span></span>](excel-calculation.md) | <span data-ttu-id="12f34-136">此示例演示如何在脚本中使用计算模式Excel web 版计算Office方法。</span><span class="sxs-lookup"><span data-stu-id="12f34-136">This sample shows how to use the calculation mode and calculate methods in Excel on the web using Office Scripts.</span></span> |
| [<span data-ttu-id="12f34-137">跨表移动行</span><span class="sxs-lookup"><span data-stu-id="12f34-137">Move rows across tables</span></span>](move-rows-across-tables.md) | <span data-ttu-id="12f34-138">此示例演示如何通过保存筛选器，然后处理和重新应用筛选器来跨表移动行。</span><span class="sxs-lookup"><span data-stu-id="12f34-138">This sample shows how to move rows across tables by saving filters, then processing and reapplying the filters.</span></span> |
| [<span data-ttu-id="12f34-139">输出Excel JSON</span><span class="sxs-lookup"><span data-stu-id="12f34-139">Output Excel data as JSON</span></span>](get-table-data.md) | <span data-ttu-id="12f34-140">此解决方案演示如何将Excel数据输出为 JSON，以用于Power Automate。</span><span class="sxs-lookup"><span data-stu-id="12f34-140">This solution shows how to output Excel table data as JSON to use in Power Automate.</span></span> |
| [<span data-ttu-id="12f34-141">从工作表的每个单元格中删除Excel超链接</span><span class="sxs-lookup"><span data-stu-id="12f34-141">Remove hyperlinks from each cell in an Excel worksheet</span></span>](remove-hyperlinks-from-cells.md) | <span data-ttu-id="12f34-142">本示例清除当前工作表的所有超链接。</span><span class="sxs-lookup"><span data-stu-id="12f34-142">This sample clears all of the hyperlinks from the current worksheet.</span></span> |
| [<span data-ttu-id="12f34-143">对文件夹中的所有 Excel 文件运行脚本</span><span class="sxs-lookup"><span data-stu-id="12f34-143">Run a script on all Excel files in a folder</span></span>](automate-tasks-on-all-excel-files-in-folder.md) | <span data-ttu-id="12f34-144">此项目对位于 OneDrive for Business (文件夹中的所有文件执行一组自动化任务，SharePoint文件夹) 。</span><span class="sxs-lookup"><span data-stu-id="12f34-144">This project performs a set of automation tasks on all files situated in a folder on OneDrive for Business (can also be used for a SharePoint folder).</span></span> <span data-ttu-id="12f34-145">该代码对Excel文件执行计算，添加格式，并插入一个@mentions注释。</span><span class="sxs-lookup"><span data-stu-id="12f34-145">It performs calculations on the Excel files, adds formatting, and inserts a comment that @mentions a colleague.</span></span> |
| [<span data-ttu-id="12f34-146">编写大型数据集</span><span class="sxs-lookup"><span data-stu-id="12f34-146">Write a large dataset</span></span>](write-large-dataset.md) | <span data-ttu-id="12f34-147">此示例演示如何将较大区域作为较小的子范围发送。</span><span class="sxs-lookup"><span data-stu-id="12f34-147">This sample shows how to send a large range as smaller subranges.</span></span> |

## <a name="scenarios"></a><span data-ttu-id="12f34-148">应用场景</span><span class="sxs-lookup"><span data-stu-id="12f34-148">Scenarios</span></span>

<span data-ttu-id="12f34-149">Office脚本可以自动执行日常例程的某些部分。</span><span class="sxs-lookup"><span data-stu-id="12f34-149">Office Scripts can automate parts of your daily routine.</span></span> <span data-ttu-id="12f34-150">这些日常任务通常存在于独特的生态系统中，其中Excel以特定方式设置的特定工作簿。</span><span class="sxs-lookup"><span data-stu-id="12f34-150">These day-to-day tasks often exist in unique ecosystems, with Excel workbooks that are set up in particular ways.</span></span> <span data-ttu-id="12f34-151">这些较大的方案示例演示了此类实际用例。</span><span class="sxs-lookup"><span data-stu-id="12f34-151">These larger scenario samples demonstrate such real-world use-cases.</span></span> <span data-ttu-id="12f34-152">它们包括Office脚本和工作簿，因此您可从头到尾查看方案。</span><span class="sxs-lookup"><span data-stu-id="12f34-152">They include both the Office Scripts and the workbooks, so you can see the scenario from end to end.</span></span>

| <span data-ttu-id="12f34-153">应用场景</span><span class="sxs-lookup"><span data-stu-id="12f34-153">Scenario</span></span> | <span data-ttu-id="12f34-154">详细信息</span><span class="sxs-lookup"><span data-stu-id="12f34-154">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="12f34-155">分析 Web 下载项</span><span class="sxs-lookup"><span data-stu-id="12f34-155">Analyze web downloads</span></span>](../scenarios/analyze-web-downloads.md) | <span data-ttu-id="12f34-156">此方案具有分析 Web 流量记录的脚本，以确定用户的来源国家/地区。</span><span class="sxs-lookup"><span data-stu-id="12f34-156">This scenario features a script that parses web traffic records to determine a user's country of origin.</span></span> <span data-ttu-id="12f34-157">它展示文本分析、在脚本中使用子功能、应用条件格式和使用表的技能。</span><span class="sxs-lookup"><span data-stu-id="12f34-157">It showcases the skills of text parsing, using subfunctions in scripts, applying conditional formatting, and working with tables.</span></span> |
| [<span data-ttu-id="12f34-158">从 NOAA 中提取图形水级别的数据</span><span class="sxs-lookup"><span data-stu-id="12f34-158">Fetch and graph water-level data from NOAA</span></span>](../scenarios/noaa-data-fetch.md) | <span data-ttu-id="12f34-159">此方案使用Office脚本从 NOAA ([Currents](https://tidesandcurrents.noaa.gov/)数据库的外部源提取数据) 并绘制结果信息的图形。</span><span class="sxs-lookup"><span data-stu-id="12f34-159">This scenario uses an Office Script to pull data from an external source (the [NOAA Tides and Currents database](https://tidesandcurrents.noaa.gov/)) and graph the resulting information.</span></span> <span data-ttu-id="12f34-160">它重点介绍了使用 `fetch` 获取数据和使用图表的技能。</span><span class="sxs-lookup"><span data-stu-id="12f34-160">It highlights the skills of using `fetch` to get data and using charts.</span></span> |
| [<span data-ttu-id="12f34-161">成绩计算器</span><span class="sxs-lookup"><span data-stu-id="12f34-161">Grade calculator</span></span>](../scenarios/grade-calculator.md) | <span data-ttu-id="12f34-162">此方案具有一个脚本，用于验证教师的课堂成绩记录。</span><span class="sxs-lookup"><span data-stu-id="12f34-162">This scenario features a script that validates an instructor's record for their class's grades.</span></span> <span data-ttu-id="12f34-163">它展示错误检查、单元格格式设置和正则表达式的技能。</span><span class="sxs-lookup"><span data-stu-id="12f34-163">It showcases the skills of error checking, cell formatting, and regular expressions.</span></span> |
| [<span data-ttu-id="12f34-164">在 Teams 中安排面试</span><span class="sxs-lookup"><span data-stu-id="12f34-164">Schedule interviews in Teams</span></span>](../scenarios/schedule-interviews-in-teams.md) | <span data-ttu-id="12f34-165">此方案演示如何使用 Excel 电子表格管理访谈式会议时间，并创建一个流来安排Teams。</span><span class="sxs-lookup"><span data-stu-id="12f34-165">This scenario shows how to use an Excel spreadsheet to manage interview meeting times and make a flow to schedules meetings in Teams.</span></span> |
| [<span data-ttu-id="12f34-166">任务提醒</span><span class="sxs-lookup"><span data-stu-id="12f34-166">Task reminders</span></span>](../scenarios/task-reminders.md) | <span data-ttu-id="12f34-167">此方案在Office流Power Automate脚本，向同事发送更新项目状态的提醒。</span><span class="sxs-lookup"><span data-stu-id="12f34-167">This scenario uses an Office Script in a Power Automate flow to send reminders to coworkers to update a project's status.</span></span> <span data-ttu-id="12f34-168">它重点介绍了脚本Power Automate和数据传输的专业技能。</span><span class="sxs-lookup"><span data-stu-id="12f34-168">It highlights the skills of Power Automate integration and data transfer to and from scripts.</span></span> |

## <a name="community-contributions-and-fun-samples"></a><span data-ttu-id="12f34-169">Community贡献和有趣的示例</span><span class="sxs-lookup"><span data-stu-id="12f34-169">Community contributions and fun samples</span></span>

<span data-ttu-id="12f34-170">欢迎来自[我们的](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md)脚本Office贡献！</span><span class="sxs-lookup"><span data-stu-id="12f34-170">We welcome [contributions](https://github.com/OfficeDev/office-scripts-docs/blob/master/Contributing.md) from our Office Scripts community!</span></span> <span data-ttu-id="12f34-171">可随意创建拉取请求进行审阅。</span><span class="sxs-lookup"><span data-stu-id="12f34-171">Feel free to create a pull request for review.</span></span>

| <span data-ttu-id="12f34-172">Project</span><span class="sxs-lookup"><span data-stu-id="12f34-172">Project</span></span> | <span data-ttu-id="12f34-173">详细信息</span><span class="sxs-lookup"><span data-stu-id="12f34-173">Details</span></span> |
|---------|---------|
| [<span data-ttu-id="12f34-174">游戏生活</span><span class="sxs-lookup"><span data-stu-id="12f34-174">Game of Life</span></span>](https://techcommunity.microsoft.com/t5/excel-blog/ready-player-zero/ba-p/2246208) | <span data-ttu-id="12f34-175">位于 Tech Excel 上的 Yutao Community"Ready Player Zero"博客包含一个脚本，用于为 John Conway 的《生活游戏》[*建模*](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life)。</span><span class="sxs-lookup"><span data-stu-id="12f34-175">The "Ready Player Zero" blog by Yutao Huang on the Excel Tech Community includes a script to model John Conway's [*The Game of Life*](https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life).</span></span> |
| [<span data-ttu-id="12f34-176">四年问候语动画</span><span class="sxs-lookup"><span data-stu-id="12f34-176">Seasons greetings animation</span></span>](community-seasons-greetings.md) | <span data-ttu-id="12f34-177">此脚本由 [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) 在假日假日的快乐中贡献！</span><span class="sxs-lookup"><span data-stu-id="12f34-177">This script was contributed by [Leslie Black](https://www.linkedin.com/in/lesblackconsultant/) in the spirit of the holiday season!</span></span> <span data-ttu-id="12f34-178">这是一个有趣的脚本，它使用脚本在Excel web 版中显示一Office树。</span><span class="sxs-lookup"><span data-stu-id="12f34-178">It's a fun script that shows a singing Christmas tree in Excel on the web using Office Scripts.</span></span> |

## <a name="try-it-out"></a><span data-ttu-id="12f34-179">试用</span><span class="sxs-lookup"><span data-stu-id="12f34-179">Try it out</span></span>

<span data-ttu-id="12f34-180">这些示例是开源的。</span><span class="sxs-lookup"><span data-stu-id="12f34-180">These samples are open source.</span></span> <span data-ttu-id="12f34-181">尝试一下。</span><span class="sxs-lookup"><span data-stu-id="12f34-181">Try them out yourself.</span></span> <span data-ttu-id="12f34-182">你将需要来自工作或学校的 Microsoft 工作或学校帐户，并拥有许可证才能Microsoft 365 E3 (或) 。</span><span class="sxs-lookup"><span data-stu-id="12f34-182">You'll need a Microsoft work or school account from work or school with a license to Microsoft 365 subscription (E3 or above).</span></span> <span data-ttu-id="12f34-183">只需前往登录 https://office.com 帐户并开始使用。</span><span class="sxs-lookup"><span data-stu-id="12f34-183">Just head over to https://office.com to sign in to your account and get started.</span></span>

## <a name="leave-a-comment"></a><span data-ttu-id="12f34-184">留下注释</span><span class="sxs-lookup"><span data-stu-id="12f34-184">Leave a comment</span></span>

<span data-ttu-id="12f34-185">使用特定示例的文档页面底部的"反馈"部分，可以随意留下评论、提出建议或记录问题。</span><span class="sxs-lookup"><span data-stu-id="12f34-185">Feel free to leave a comment, make a suggestion, or log an issue by using the **Feedback** section at the bottom of the specific sample's documentation page.</span></span>
